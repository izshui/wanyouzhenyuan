<!doctype html>
<html lang="en" data-bs-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#4cb050" />
    <meta name="keywords" content="万有真原, 天主教小助手, 教会新闻, 思高圣经, 牧灵圣经, 教会节日, 教堂搜索, 教会音乐, 日课, 读经, 弥撒, 诵读, 晨祷, 日祷, 晚祷, 夜祷, 反省, 礼仪, 圣人传记">
    <meta name="description" content="小助手在特别时段为教友们提供弥撒及礼仪活动直播">
    <link rel="icon" href="https://www.wanyouzhenyuan.cn/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="https://res.kenahan.com/statics/v2/img/icon/app-icon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://res.kenahan.com/statics/v2/img/icon/app-icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://res.kenahan.com/statics/v2/img/icon/app-icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="https://res.kenahan.com/statics/v2/img/icon/app-icon-167.png">
    <link rel="stylesheet" type="text/css" href="https://res.kenahan.com/statics/v2/js/bootstrap-5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://res.kenahan.com/statics/v2/js/bootstrap-5.3.3/dist/font/bootstrap-icons.min.css">
    <link rel="stylesheet" type="text/css" href="https://res.kenahan.com/statics/v2/css/main.css?v=4">
    <title>直播 - 万有真原</title>
    <!-- begin gtm -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WSQGD72L');</script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5T6KB41QB8"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5T6KB41QB8');
    </script>
    <!-- end gtm -->
    <script>
        const V2_STATIC_PATH = "https://res.kenahan.com/statics/v2";
        const EASTER_DOMAIN = "https://www.chinacath.cn/";
        const APP_DOWNLOAD_URL = "https://www.chinacath.cn/s/2/2";
        const WX_OPEN_ID = "";
        const PAY_BUSINESS_TYPE = "live";
        let PAY_BUSINESS_ID = "";
        let pageMeta = {"site_title":"\u4e07\u6709\u771f\u539f","stitle":"\u76f4\u64ad","module":"\u76f4\u64ad","title":"\u76f4\u64ad - \u4e07\u6709\u771f\u539f","keyword":"\u4e07\u6709\u771f\u539f, \u5929\u4e3b\u6559\u5c0f\u52a9\u624b, \u6559\u4f1a\u65b0\u95fb, \u601d\u9ad8\u5723\u7ecf, \u7267\u7075\u5723\u7ecf, \u6559\u4f1a\u8282\u65e5, \u6559\u5802\u641c\u7d22, \u6559\u4f1a\u97f3\u4e50, \u65e5\u8bfe, \u8bfb\u7ecf, \u5f25\u6492, \u8bf5\u8bfb, \u6668\u7977, \u65e5\u7977, \u665a\u7977, \u591c\u7977, \u53cd\u7701, \u793c\u4eea, \u5723\u4eba\u4f20\u8bb0","description":"\u5c0f\u52a9\u624b\u5728\u7279\u522b\u65f6\u6bb5\u4e3a\u6559\u53cb\u4eec\u63d0\u4f9b\u5f25\u6492\u53ca\u793c\u4eea\u6d3b\u52a8\u76f4\u64ad","thumbnail":"https:\/\/res.kenahan.com\/app\/icon\/app-icon.png"};
    </script>
</head>

<body style="padding-top: 4rem;">
<header class="sticky-top">
    <nav class="navbar navbar-expand-lg fixed-top bg-body" aria-label="菜单栏">
        <div class="container-xl">
            <a class="navbar-brand p-0" href="index.html">
                <img src="https://res.kenahan.com/statics/v2/img/logo.jpg" class="img-fluid rounded" style="width: 40px;" alt="万有真原"/>
            </a>
            <span id="navbar-title" class="d-lg-none">直播</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbar">
                <ul id="navbar-links" class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item active"><a class="nav-link" href="index.html">首页</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=news.html">动态</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=bible.html">圣经</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=daily.html">日课</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=music.html">音频</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=live.html">直播</a></li>
                <li class="nav-item"><a class="nav-link" href="index.php%3Fm=more.html">更多</a></li>
                </ul>
                <ul class="navbar-nav">
                <li class="nav-item">
                    <form class="align-center" action="index.php.html" role="search">
                        <input name="m" value="search" type="hidden">
                        <div class="input-group">
                            <input name="keyword" type="text" class="form-control" placeholder="搜索">
                            <button class="btn btn-outline-main" type="submit" id="button-addon2"><i class="bi bi-search"></i></button>
                        </div>
                    </form>
                </li>
                <li class="nav-item dropdown">
                    <button class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center"
                            id="bd-theme"
                            type="button"
                            aria-expanded="false"
                            data-bs-toggle="dropdown"
                            data-bs-display="static"
                            aria-label="切换主题">
                            <i class="bi-circle-half"></i>
                            <span class="d-lg-none ms-2" id="bd-theme-text">切换颜色</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                        <i class="bi-sun-fill"></i>浅色<i class="bi-check2"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                        <i class="bi-moon-stars-fill"></i>深色<i class="bi-check2"></i>
                        </button>
                    </li>
                    <li>
                        <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                        <i class="bi-circle-half"></i>自动<i class="bi-check2"></i>
                        </button>
                    </li>
                    </ul>
                </li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<div id="top-guider" class="container-xl d-none">
    <div class="alert alert-warning alert-dismissible p-1 my-1" role="alert">
        <div><a class="alert-link" href="index.php%3Fm=live&amp;tm=2.html" target="_blank">直播预告： 课程 | 明达班神学课程《圣三神学》 (今天 12:50)</a></div>
        <button type="button" class="btn-close p-1 m-1"></button>
    </div>
</div>
<style>
    #player {
        width: 100% !important;
        aspect-ratio: 16/9 !important;
        height: auto !important;
        background-color: #000;
    }
</style>
<main class="mt-0">
    <div class="container-xl">
        <div class="row">
            <div class="col-lg-9">
                <div class="row">
                    <div class="col-12 py-2">
                        <div id="empty-live" class="text-white" style="aspect-ratio: 16/9; background-size: cover; background-position: center; background-repeat: no-repeat;">
                            <div class="d-flex flex-column justify-content-between h-100">
                                <div class="text-center bg-shadow">
                                    <div class="fs-5 fw-bold p-2">暂无直播</div>
                                </div>
                                <div class="p-2 fs-7 bg-shadow">
                                    <div>下一节目：<span id="next-live-title"></span>（<span id="next-live-time"></span>）</div>
                                </div>
                            </div>
                        </div>
                        <div id="player" class="d-none"></div>
                    </div>
                    <div id="next-track-preview" class="col-12 text-muted fs-7 mb-2 text-line-1">
                        <span>预告：</span>
                        <span id="next-track-title"></span>
                    </div>
                    <div class="col-12">
                        <div class="row">
                            <div class="col-4 col-sm-3 col-md-2">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text" id="basic-addon1"><i class="bi bi-person"></i></span>
                                    <input id="send-sender" type="text" class="form-control" placeholder="昵称">
                                </div>
                            </div>
                            <div class="col-8 col-sm-9 col-md-10">
                                <div class="input-group">
                                    <input id="send-msg" type="text" class="form-control form-control-sm" placeholder="向主持人分享你的想法">
                                    <button id="send-btn" class="btn btn-outline-main btn-sm" type="button">发送</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 text-center mt-2 mb-3">
                        <span class="text-muted fs-7">推荐<a href="https://www.chinacath.cn/s/2/2" target="_blank">下载App</a>(支持节目回放、节目预约、投屏到电视)</span>
                    </div>
                </div>
                <div class="wxpay pb-3">
    <div class="text-center">
        <button id="wxpay-btn" type="button" class="btn btn-main"><i class="bi bi-hand-thumbs-up"></i>赞赏</button>
    </div>
    <div id="wxpay-box" class="text-center" style="display: none;">
        <div class="row my-2">
            <div class="col-sm-2"></div>
            <div id="wxpay-amount-group" class="btn-group col-sm-8" role="group">
                <button type="button" class="btn btn-outline-main" data-amount="1">1元</button>
                <button type="button" class="btn btn-outline-main" data-amount="5">5元</button>
                <button type="button" class="btn btn-outline-main" data-amount="10">10元</button>
                <button type="button" class="btn btn-outline-main" data-amount="50">50元</button>
                <button type="button" class="btn btn-outline-main" data-amount="100">100元</button>
            </div>
            <div class="col-sm-2"></div>
        </div>
        <div class="row my-2">
            <div class="col-sm-2"></div>
            <div class="col-sm-6 col-9">
                <div class="input-group mb-3">
                    <span class="input-group-text"><img style="height: 1.5rem;"
                        src="https://res.kenahan.com/statics/v2/img/wxpay-logo.png"></span>
                    <input id="wxpay-amount" type="number" min="1" max="10000" class="form-control text-end" placeholder="输入金额" value="1">
                    <span class="input-group-text">元</span>
                </div>
            </div>
            <div class="col-sm-2 col-3 text-center">
                <button id="wxpay-submit" class="btn btn-main" type="button">支付</button>
            </div>
            <div class="col-sm-2"></div>
        </div>
        <div class="row">
            <div class="col-12">
                <div id="wxpay-qrcode"></div>
                <div id="wxpay-tips">
                    <strong>打开微信扫码，完成赞赏</strong>
                </div>
            </div>
        </div>
    </div>
</div>
                <div class="row">
                    <div class="col-12 article">
                        <div class="article-title text-start"></div>
                        <div class="article-subtitle text-line-1 pt-2 text-start"></div>
                        <div class="article-content" style="text-wrap: auto;"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3">
                
<div class="row">
    <!-- 热门文章-->
    
    <!-- 推荐专辑-->
    
    <!-- 推荐歌单-->
        

    <!-- 近期节日 -->
    
    <!-- 推荐歌手 -->
    
    <!-- 热门教堂 -->
    
    <!-- 直播预告 -->
        <div class="col-12 col-lg-12 col-md-6 col-sm-6">
        <div class="my-3">
            <ul class="nav nav-underline">
                <li class="nav-item">
                    <a class="nav-link px-2 py-1 active" data-bs-toggle="tab" href="index.php%3Fm=live&amp;ref=menu132.html#tab-scheduled">直播预告</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-2 py-1" data-bs-toggle="tab" href="index.php%3Fm=live&amp;ref=menu132.html#tab-playback">直播回放</a>
                </li>
            </ul>
            <div class="border-bottom" style="margin-top: -1px;"></div>
            <div class="tab-content my-2">
                <div id="tab-scheduled" class="tab-pane active">
                    
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">课程 | 明达班神学课程《圣三神学》</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">明天 12:50</div>
                            <a href="index.php%3Fm=live&amp;track_id=5855.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">预约</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">热心敬礼 | 下午三点时刻</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">明天 14:30</div>
                            <a href="index.php%3Fm=live&amp;track_id=5856.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">预约</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">课程 | 明达班神学课程《圣三神学》</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">明天 15:30</div>
                            <a href="index.php%3Fm=live&amp;track_id=5857.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">预约</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">重播 | 雨水音乐公开课</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">明天 19:30</div>
                            <a href="index.php%3Fm=live&amp;track_id=5858.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">预约</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">直播 | 与露德圣母朝圣地一起诵念玫瑰经</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">明天 20:55</div>
                            <a href="index.php%3Fm=live&amp;track_id=5859.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">预约</a>
                        </div>
                    </div>
                                    </div>
                <div id="tab-playback" class="tab-pane">
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">直播 | 与露德圣母朝圣地一起诵念玫瑰经</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">今天 20:50</div>
                            <a href="index.php%3Fm=live&amp;track_id=5854.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">回放</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">分享 | 马尔谷福音导读 第20讲</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">今天 19:40</div>
                            <a href="index.php%3Fm=live&amp;track_id=5853.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">回放</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">热心敬礼 | 下午三点时刻</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">今天 14:30</div>
                            <a href="index.php%3Fm=live&amp;track_id=5852.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">回放</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">直播 | 与露德圣母朝圣地一起诵念玫瑰经</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">昨天 20:45</div>
                            <a href="index.php%3Fm=live&amp;track_id=5851.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">回放</a>
                        </div>
                    </div>
                                        <div class="w-100 d-flex flex-column border-bottom py-2">
                        <div class="text-line-2">热心敬礼 | 下午三点时刻</div>
                        <div class="d-flex">
                            <div class="flex-grow-1 align-self-center text-body-secondary text-line-1">昨天 14:30</div>
                            <a href="index.php%3Fm=live&amp;track_id=5850.html" target="_blank" class="btn btn-sm btn-outline-main text-nowrap">回放</a>
                        </div>
                    </div>
                                    </div>
            </div>
        </div>
    </div>
        <div class="col-12 col-lg-12 col-md-6 col-sm-6">
        <!-- 热门标签 -->
                
        <!-- 快搜教堂 -->
        <div class="my-3">
            <a href="index.php%3Fm=church.html" target="_blank">
                <img src="https://res.kenahan.com/statics/v2/img/ksou-church-2x.png" class="w-100 img-fluid">
            </a>
        </div>
        <!-- 扫码下载 -->
        <div class="my-3">
            <a href="https://www.chinacath.cn/s/2/2" target="_blank">
                <img src="https://res.kenahan.com/statics/v2/img/download-app-2x.png" class="w-100 img-fluid">
            </a>
        </div>
    </div>
</div>            </div>
        </div>
    </div>
</main>
<footer class="bg-body-tertiary py-4 mt-4">
    <div class="container-xl">
        <div class="row">
            <div class="col-sm-12 col-md-6">
                <h5>关于我们</h5>
                <div>
                    <p>“万有真原”是一款针对大公教会的信仰辅助工具，致力于帮助大家更好的在信仰内生活。</p>
                    <p>现有原创栏目“信仰分享”，期待大家积极分享自己对信仰的心得体会。</p>
                    <ul class="list-unstyled">
                        <li>投稿邮箱： tougao@kenahan.com &nbsp;&nbsp;<a href="index.php%3Fm=news&amp;a=content&amp;id=17294.html">(详情点击)</a></li>
                        <li>问题反馈： fankui@kenahan.com</li>
                    </ul>
                </div>
            </div>
            <div class="col-sm-8 col-md-4">
                <h5>友情链接</h5>
                <div class="row">
                    <div class="col-sm-6">
                        <ul class="list-unstyled d-flex flex-column gap-1">
                            <li><a href="http://www.vaticannews.cn/" target="_blank">梵蒂冈新闻网</a></li>
                            <li><a href="https://www.catholic-bj.cn/" target="_blank">北京教区</a></li>
                            <li><a href="https://www.jiaolizhongxin.com/" target="_blank">辽宁教理中心</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-6">
                        <ul class="list-unstyled d-flex flex-column gap-1">
                            <li><a href="https://www.hdcatholic.cn/" target="_blank">邯郸教区</a></li>
                            <li><a href="https://www.zhouzhidiocese.com/" target="_blank">周至教区</a></li>
                            <li><a href="https://www.tzjxant.com/?ref=cathassist" target="_blank">西安南堂</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 col-md-2">
                <h5>关注我们</h5>
                <div class="col-12">
                    <ul class="list-unstyled d-flex flex-column gap-1">
                        <li><a href="https://www.chinacath.cn/s/2/2" target="_blank">下载“万有真原”</a></li>
                        <li><a href="index.php%3Fm=goto&amp;t=shop&amp;tm=1742569364.html" target="_blank">网店</a></li>
                        <li><a href="index.php%3Fm=goto&amp;t=about.html" target="_blank">支持我们</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <ul class="list-unstyled d-flex flex-wrap gap-2 justify-content-center">
            <li>©2013-2025, 天主教北京教区西什库教堂 所有</li>
            <li><a href="http://beian.miit.gov.cn" target="_blank" style="color:#959595;">京ICP备2022026334号</a></li>
            <li><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010202010405" target="_blank" style="color:#959595;"><img src="https://res.kenahan.com/statics/v2/img/gongan.png" style="overflow-clip-margin: content-box; overflow: clip; height: 1.2em;">京公网安备 11010202010405号</a></li>
            <li>互联网宗教信息服务许可证：京（2022）0000098</li>
        </ul>
    </div>
</footer>
<div class="toast-container position-fixed bottom-0 end-0 p-3"></div>
</body>
<script type="application/javascript" src="https://res.kenahan.com/statics/v2/js/bootstrap-5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script type="application/javascript" src="https://res.kenahan.com/statics/v2/js/jquery-3.7.1/dist/jquery.min.js"></script>
<script type="application/javascript" src="https://res.kenahan.com/statics/v2/js/qrcode.min.js"></script>
<script type="application/javascript" src="https://res.kenahan.com/statics/v2/js/common.js?v=11"></script>
<script type="application/javascript" src="https://res.kenahan.com/statics/v2/js/home.js"></script>
<!-- begin gtm -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WSQGD72L"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- end gtm -->
</html>
<link rel="stylesheet" href="https://res.kenahan.com/statics/v2/js/xgplayer/xgplayer-3.0.21.min.css"/>
<script src="https://res.kenahan.com/statics/v2/js/xgplayer/xgplayer-3.0.21.min.js"></script>
<script src="https://res.kenahan.com/statics/v2/js/xgplayer/xgplayer-hls-3.0.21.min.js"></script>
<script>
    let currentEvent = null;
    let currentTrack = null;
    let nextEvent = null;
    let nextTrack = null;
    let player = null;
    let refreshTimer = null;

    const updateArticle = function () {
        $('.article').show();
        if(currentEvent) {
            if(currentTrack) {
                $(".article-title").text(currentTrack.title);
                $(".article-subtitle").text(util.friendlyTime(currentTrack.beginTime));
            } else {
                $(".article-title").text(currentEvent.title);
                $(".article-subtitle").text(util.friendlyTime(currentEvent.beginTime));
            }
            $(".article-content").html(currentEvent.description);
        } else {
            $(".article-title").text(nextEvent.title);
            $(".article-subtitle").text(util.friendlyTime(nextEvent.beginTime));
            $(".article-content").html(nextEvent.description);
        }

        if(nextTrack) {
            $("#next-track-preview").show();
            $("#next-track-title").text(`(${util.friendlyTime(nextTrack.beginTime)})${nextTrack.title}`);
        } else {
            $("#next-track-preview").hide();
        }
    }

    // 设置空直播
    const setEmptyLive = function () {
        currentEvent = null;
        currentTrack = null;
        if(player) {
            player.destroy();
            player = null;
        }
        showNextLive();
        updateArticle();
    }

    // 显示下一节目
    const showNextLive = function () {
        if(nextEvent) {
            PAY_BUSINESS_ID = nextEvent.id;
            $("#player").addClass('d-none');
            $("#empty-live").removeClass('d-none');

            // set background image, and keep aspect ratio
            $("#empty-live").css('background-image', `url(${nextEvent.poster})`);
            $("#next-live-title").text(nextEvent.title);
            $("#next-live-time").text(util.friendlyTime(nextEvent.beginTime));
        }
    }

    // 设置直播
    const setLiveEvent = function (event, track) {
        if(!event || !track) {
            setEmptyLive();
            return;
        }

        if(currentTrack && currentTrack.id == track.id) {
            return;
        }

        // 直播发生改变
        currentEvent = event;
        currentTrack = track;
        PAY_BUSINESS_ID = currentEvent.id;
        updateArticle();
        $("#player").removeClass('d-none');
        $("#empty-live").addClass('d-none');

        if(!player) {
            let definitions = [];
            $.each(currentEvent.stream.channels, function (i, s) {
                definitions.push({definition:s.name, url: s.hls});
            });

            const config = {
                id: 'player',
                url: currentEvent.stream.hls,
                playsinline: true,
                poster: currentEvent.poster,
                plugins: [HlsPlayer],
                ignores: ['progress', 'playbackrate', 'cssFullScreen', 'time'],
                'x5-video-player-type': 'h5',
                'x5-video-player-fullscreen': 'true',
                pip: true,
                isLive: true,
                definition: {
                    list: definitions,
                },
                autoplay: false
            }
            player = new Player(config);
        }
    }

    // 刷新直播
    const refreshLive = function () {
        $.ajax({
            url: EASTER_DOMAIN + 'api/live/v2',
            type: "get",
            dataType: "json",
            success: function (data, dataStatus) {
                const now = util.cvtChineseTime(data.content.now);

                let nowEvent = null;
                let nowTrack = null;

                if(data.content.events && data.content.events.length > 0) {
                    for(let i = 0; i < data.content.events.length; i++) {
                        const e = data.content.events[i];
                        if(nowEvent || util.cvtChineseTime(e.beginTime) > now) {
                            // 设置下一个节目
                            nextEvent = e;
                            nextTrack = e.tracks[0];
                            break;
                        }
                        if(util.cvtChineseTime(e.beginTime) <= now && util.cvtChineseTime(e.endTime) >= now) {
                            nowEvent = e;
                        }
                    }
                }

                if(nowEvent) {
                    let lastTrack = null;
                    for(let i = 0; i < nowEvent.tracks.length; i++) {
                        const t = nowEvent.tracks[i];
                        if(util.cvtChineseTime(t.beginTime) >= now) {
                            nextTrack = t;
                            break;
                        }
                        lastTrack = t;
                    }
                    nowTrack = lastTrack;
                }

                setLiveEvent(nowEvent, nowTrack);
                setRefreshTimer();
            }
        });
    }

    // 设置定时刷新
    const setRefreshTimer = function () {
        if(refreshTimer) {
            clearInterval(refreshTimer);
            refreshTimer = null;
        }

        let diff = 0;
        let now = new Date();
        if(nextTrack) {
            let endTime = util.cvtChineseTime(nextTrack.beginTime);
            if(currentEvent && util.cvtChineseTime(nextTrack.beginTime) > util.cvtChineseTime(currentEvent.endTime)) {
                endTime = util.cvtChineseTime(currentEvent.endTime);
            }
            diff = endTime.getTime() - now.getTime();
        }

        if(diff < 1000*60*2 || isNaN(diff)) {
            // 如果时间小于2分钟，则设置为2分钟
            diff = 1000*60*2;
        }
        refreshTimer = setInterval(function () {
            refreshLive();
        }, diff/2);
    }

    // 发送消息反馈
    const sendMsg = function () {
        const msg = $("#send-msg").val();
        if (msg == undefined || msg.length < 3) {
            showToast("您输入的想法太短，至少三个字");
            return;
        }
        const sender = $("#send-sender").val();
        if (!sender) {
            showToast("请先输入昵称");
            return;
        }

        let eventId = nextEvent.id;
        if(currentEvent) {
            eventId = currentEvent.id;
        }

        util.setStorage("liveSendSender", sender);
        $.ajax({
            url: EASTER_DOMAIN + 'api/live/msg',
            type: "post",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({
                liveEventId: eventId,
                message: msg,
                sender: sender
            }),
            success: function (data, dataStatus) {
                if (data.code != 200) {
                    showToast(data.message);
                } else {
                    showToast("消息发送成功");
                    $("#send-msg").val("");
                }
            },
            error: function () {
                showToast("发送失败，请稍后重试");
            }
        });
    }

    $(document).ready(function() {
        const sender = util.getStorage("liveSendSender");
        if (sender) {
            $("#send-sender").val(sender);
        }

        $("#send-btn").on('click', function (e) {
            sendMsg();
        });

        refreshLive();
    });
</script>